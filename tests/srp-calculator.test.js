import {SRPCalculator} from '../src/srp-calculator';
import {NodeRuntime} from './node-runtime';
import {parseBigInt} from '../src/parse-bigint';
describe('SRPCalculator', () => {
	let runtime, underTest;
	beforeEach(() => {
		runtime = new NodeRuntime();
		underTest = new SRPCalculator({runtime});
	});
	describe('getSignature', () => {
		[
			{
			  userPoolName: '1wCnYCULD',
			  username: 'f842d0d4-3f80-45c3-8147-1ee7bfef6901',
			  challengeParameters: {
				  SALT: '6fe8be25566ff6f4a15784581d95506e',
				  SECRET_BLOCK: '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',
				  SRP_B: '7db9e54cb6142a44b29c2c3657f738532e3292ac07f56ecea7789b02a1e5826f7e07b89161a50c532e65037926f8ee0a4ef5cda526670d3c4e3cbf04bf350051b8789306e2995a80cb7ba85f26e708887d4e4a1cc97e30295bc9e02f9f729fb917924f16ca21ab170e192641578f206d76f67a5e60f1b76b67433c69530a27b0db42bbe6388a807a0e0d8ee27aae57a8e9c8ded038ba8a8ae1209681983d07cda47c35898c781ebea39176b632ec6de1b72b32ba3c625d4faea384edf2ccce142405ac7cddbbe590b68451d0de5ebb83c49abec4f476a25ca643bc110d45aae8298fe98ac131707c765ed18d30bbbe243ec51593793de5f97f0e897031596ed642dc5ec87b12a197df6fc1ddcfc91f37988b5e6d16552b50440e6593361e555efacea24641adcafd7eeebf8905836df58a74853ec3ca9677d88470fc0b182f3d1971157e35470821d049046a5b698c9bf62b1fe3d4f34fd4c56790e94fe079cf1aa649740527c1ff56265c1416cdffeba92d08542fdcbfc5aef8cdc8a6602484',
				  USERNAME: 'f842d0d4-3f80-45c3-8147-1ee7bfef6901',
				  USER_ID_FOR_SRP: 'f842d0d4-3f80-45c3-8147-1ee7bfef6901'
			  },
			  dateNow: 'Thu Jan 30 20:00:25 UTC 2025',
			  hkdf: Uint8Array.from([ 72, 130, 123,  20, 142, 207, 63,  61, 100, 120, 190,  70, 210,   0,  48, 109 ]),
			  signatureString: 'CwNuJBpZzIl4qXQC8ihvuhx1qT/0MqISXEzYgMXHfG4='
			},
			{
				userPoolName: '1wCnYCULD',
				username: 'bcd87241-a700-4356-97a5-7952bca487c8',
				challengeParameters: {
					SALT: '55226fc83948461c4ec4c9017a9ec890',
					SECRET_BLOCK: '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',
					SRP_B: '3f91c07dcf379abda058857d6bae7c7211f0329e9451957165bfad82a191182bb7327c12b645450b89332bc52849c2ca085d302cd6f3e49616374ee867127d619bb902d567231ac545d30fdf63b8003ac6234bd7ecae69314faa571b826fe7f00f0b803dd28c8c750ad2c182acf0e87584767360e5cb8b41f3071f8e4d004d50751a53e8c3bf927859f90c65d372a416a0c1588020fa3976cfdd63179960f982f305d0d45ec3c973863834f806755c57b0332d31c707edbeaba45cf771dcd678dad77323ee9302b467a503b8272677724d94d3371df29af6354ca8f0629b3d0cc8de2a13e56735d3ff32387617f0589ea295fc06f7a11f0b4bda925110dcab8141e935017a156c82884820c74e8cb0cdcfaf36772af61d197ac6b0213a4014accb6daf3d660ab9c26e769708a7ce991da89d3e75094c17c012b450379a48c69a2bdb5006575bf8fa6102fd3348682cfe843764c682b2b2a381fe9d9d2a3845f0d2d9feeddde7508ebadea31523618315a937cd46f7862368f837cd1eeb8f1a2d',
					USERNAME: 'bcd87241-a700-4356-97a5-7952bca487c8',
					USER_ID_FOR_SRP: 'bcd87241-a700-4356-97a5-7952bca487c8'
				},
				dateNow: 'Thu Jan 30 20:00:23 UTC 2025',
				hkdf: Uint8Array.from([ 229,   4,  93, 108, 188, 122, 156, 248, 200, 139, 208, 183,  87, 242,  93, 32 ]),
				signatureString: 'Zz6QKodXOj6OcaIR10VnxVQKoeHRSV08UgMW7UK6pMA='
			},
			{
				userPoolName: '1wCnYCULD',
				username: '3c9f94d7-e672-4e68-b141-7f61aec14f50',
				challengeParameters: {
					SALT: '7e05ae7a2c8e5ee5b6ec9e9db9af50f3',
					SECRET_BLOCK: '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',
					SRP_B: '6b37393ae5ac0d9d92d66fbdf8ebcae671862a8ddfbbce54015242677ec50ad65c6cb2f814c7c83730c65d704a45ec17b98372578f88772946ae4603396ed2615d13d78aa9946d84639082265821cbf521465a469e70e690c1f38ed2a7fd4ca8167cbbf5ffea929b452629adcc086fed5dd82a2c6416a460d9f77c74d4d7a9390c5a45f4bd27a4539b08f5e00b58800ca17ba3f7228b052c8fd2da0942d440c477fcb5f0b4c2eb44456c55c3e3311eaba39664522a0df7e177f9bd55dba2776cfcc2ae4c68996aa91d5a59e184decff952e614e429166cad45fc3539678d2cc0e86a6cee4e411b1e17e7598e0e0ae83f00bd05164c357c03268a047e26ec241d80fa2e94d9831570fba9e34d081dc1b0fa910629c146da3efe818218d8cda6195f49e534c00915b33a427989f5c3c62990f0f64c9b37c3ce3316d67e5e21d1df70202737927444506e73929b427518a6bd5dda7f827ad666a4ec5856cc562172644195d65b99b0a3351aa8678b057a68367a5197ba93eaf396b18feae4909252',
					USERNAME: '3c9f94d7-e672-4e68-b141-7f61aec14f50',
					USER_ID_FOR_SRP: '3c9f94d7-e672-4e68-b141-7f61aec14f50'
				},
				dateNow: 'Thu Jan 30 20:00:03 UTC 2025',
				hkdf: Uint8Array.from( [ 153,  6,  78, 218, 230, 206, 43, 87, 101, 249,  16, 127, 89,  6, 183, 192 ]),
				signatureString: 'q7dMR2usqp+npqeutF5is2+8kRny8ZZwEEf/Jz3Kdjo='
			},
			{
				userPoolName: '1wCnYCULD',
				username: 'a9996db7-ee16-45bc-852f-6efddc01338c',
				challengeParameters: {
					SALT: '836ce3d6c7da1e9a318bd0095274a575',
					SECRET_BLOCK: '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',
					SRP_B: '89e3d8be156c76931cb4092716dfe766d5a7fb2cb481839e3578bb874f78284945b0a391ef8fd0a0ce4f5d5ef6fde116d2cc83c0f2601edceaa5d4d7b438e538ffe59cae843e2ec1499fe91c2af3258e83ea32aef5d17b5c6f62373ee0c65eec1287aa3f0c42e9b770da84f9dd1436691cc05377e489b8bd2e7580f672b21157cfa2160d53eb6b9ead55bda5d6e6ec6d63d2edd3f73f594daa3f5a85c169e4ec8078df7830db3429222dde4853d04457489f03397b54af75938e0581e2173eec07ddddb207201b7710340cb742bd2d1e4a603cc0140990274c6e15f861151ce23e926c25ec4aca05833544eaa4c54ac51c252dab61b0bc1024f8233be709f48d6fecc04627c6e7005890ff4135ebcf97dc9de4ebf922095e178aa731d67995023d8abeca18d0dd617327e14459f3c1697960fa43c22f22eede51a30bd8141c1cb80f2ddca2fe37335d555dc3c2f17974982c7fe7ecc7b221aaff116c88bb04e82dd5f4d9f04e676f3428621930b0332e6f0809b97387e22499508e33613f9a04',
					USERNAME: 'a9996db7-ee16-45bc-852f-6efddc01338c',
					USER_ID_FOR_SRP: 'a9996db7-ee16-45bc-852f-6efddc01338c'
				},
				dateNow: 'Thu Jan 30 20:11:20 UTC 2025',
				hkdf: Uint8Array.from([ 144, 103, 207, 181, 183, 175, 232, 157, 189, 167, 94,  43, 131, 193,  75, 151 ]),
				signatureString: 'opS7+fHjI0xht3u40M6NscOZy7pilW9w7WE1iCg/aC4='
			},
			{
				userPoolName: '1wCnYCULD',
				username: 'fa3a8195-7485-4ad6-be96-4cf29ad19fef',
				challengeParameters: {
					SALT: '48b75cbe0a951f5632d0913af6ca2690',
					SECRET_BLOCK: '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',
					SRP_B: '10bcbcd3c380168db70e4b11cfc49fba73e1ba206351b75606833b66cae0a7712961cc0301f81bf1c242a3a8b752b1e89526e9d79e9046f75a08c5507f0d76f372d0dedaf4f00fc1764cdc0504be497d05f385356cb10fb44845a33404e9942bd03b6d283949b26f591c707c0a1cef3865e0a64e33530c63f5a9017d1540129b6becc993bd36856b0b614042c041c2d92b0996220b5f87b62139b9f726983a6e375110faccddb8c3232a8b3f6d1a381c148704ea1230ed34645e531e1e1b6d3c686a0d755a55d0efe2b347af8fa32837995cc90cb927ca5a77b4698f206e4cc84faa8ef6aafc0728c0db824e5aa01609ca39e49a7d96fb7639d204c1e04ae55e09dea3401d4db8654f52aab0a3f19d9e263aaad47ea0a4df0b87d174de4e6492b6a4f4da93df0d470cecbc763595bff1a27a4cb8e8d84355a566f3510575c1852b8bc66d6b61cdcc0546ee6a69c4b86b930c1908b1bf402f3f0327cfb3c3185fd046bbe1a076fe580d21852ce6c87e6205bd5d09055b3536d32867f83499d297',
					USERNAME: 'fa3a8195-7485-4ad6-be96-4cf29ad19fef',
					USER_ID_FOR_SRP: 'fa3a8195-7485-4ad6-be96-4cf29ad19fef'
				},
				dateNow: 'Thu Jan 30 20:11:24 UTC 2025',
				hkdf: Uint8Array.from( [ 63,  57,  68,  89, 160,  8, 88, 166, 176, 111,   2, 99, 19, 223, 133,  46 ]),
				signatureString: 'NYfEUxSZYCI2ZNg9CLedShBv3UgFywhQCulHKVCli6U='
			}
		].forEach(({userPoolName, username, challengeParameters, dateNow, hkdf, signatureString}, i) =>
			test(`should be consistent with precalculated SRP regression values ${i}`, () => {
				expect(underTest.getSignature({userPoolName, username, challengeParameters, dateNow, hkdf})).toEqual(signatureString);
			})
		);
	});
	describe('getPasswordAuthenticationKey', () => {
		[
			{
				username: '0ad3fd42-61e9-4c2b-b867-8d5547389d90',
				password: '$Password0Final',
				serverBValue: 'a8911430b87cfcd6438d051990aef20d3751028d5a88ff3abdae73262cf61e27e0c400f665cbbd9b2d163771e20e05a8e917def619028506d989bb888761da87f3d8987a1ac75f7ddea5a72d69c0dfc286904969311def3dcaf259fab60b4456d3bc7f1e9b2378315c96ba1fc6a0d7bb11375ee5045b511135d2c2e97c63f24219963bed4461668bcd95e2f21d7e3351c136f4166fa8b822df90de439484d08fe13be8590dfe3932928dc2a1bb2690f96b20713a63f02994e4774b5bac468a62183bb195f268bc3a9d7cafe8b5a1a9cadd90f352e66703c79fb6858d659a87327e143a780b03c1702e48ab008223f03ab7d525dea14abefcc903a53b90a9f46a6adbc8e7a9a82c0bc32b09c669f74b9a285f741ed90ff19747d7600cf115b0b9b96b6c33fda2bec618c840cd37d882763c466389dd35299a4fa561245093f21da9e8705deae7e12308c83f2e15fd09e2026802cf7e2e5a5a618359f9b4628a7ec2e989efd00902d4c4b9f934daab90cffc384627b97b1654b41a627dd6146808',
				salt: '35810b8966682638e78ed31b16331a',
				userPoolName: '1wCnYCULD',
				context: {
					N: 'ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff',
					g: '2',
					a: '2d83558b8f1e0e958d968e6de79ac3800dc6b0d5e1eacf5418db6a17b9c7f0a168feba6f23164b717c2688c3ae14fc34575c9d53fed771e8cac2bc38d551260b82d56b9daf6c5f3e2a083c90caf9ce801f621de7b735e378c3ae135d5b157500af13dfa67d439b0cc9372418a7103677c749ce11876e28de7d1b0bbadf55b14a',
					A: '5159b4cfc91b8f2dee1f1fda35582edfd62150d757fbbf25dd1cf4346932271a4cab6ae7a9f04f9262ba42218d9b94218e620e29787d44e169226879f3fb3f226aabc054a1a47fb31d8200c2b7d15c0f27c1e0dc39cfd2b8fd59aa98faea96c4f464c9a4ffecee0cbe72ec4c7a6730fee5aee46b7b04bb720e638fd8586e7219ebd79aded6f7152460f1b9a4f411d1b90124880583d738fe8db55dfe23b1a4c88b6b4f2e4cee235ffad4ff0380367e8e5c0fa09e37d71a89247e86f26f74d8bd5c787ab2c6496ed8fb342b6102124f47c4204387f33acdc8ac1f0b6f9514c93a5143615a07e511005b909ae3c8b6c6f3917ee4035c523ee5f659573701c234375c4064bd0a1917e07d7f9f67390409f83517938875fb56e29953d68501b5b871998a68c120b28c14b0136bb9ef485a60ca8a948382eed90500f6827de5c7eca2b3066acc3cd3982610e1e9b94cb6e1b586cf027354418763a0a0e4ddd082338bb08feec54e878fcc8ea2bc642ff552308994c449a84c23eab69fd6e0eda049ee',
					k: '538282c4354742d7cbbde2359fcf67f9f5b3a6b08791e5011b43b8a5b66d9ee6'
				},
				result: [232, 3, 30, 136, 209, 145, 49, 28, 189, 97, 77, 4, 222, 140, 193, 212],

			},
			{
				username: '5d53e202-da19-4e2f-9028-b6cfae1519db',
				password: '$Password0Temp',
				serverBValue: '6913a2dc19106e3c44567e17b9bc4e7ba4336b3fb7851395afca688029d3e6c2224db1a229d980c3d16b943085cd85e7659a3fdc3ff01c60f2ca550d039e8c0eabf51445fa1e70aea5313a646edfa70d7e6fb69b5f423bcbeb0bb37731db02101684dd858e157acc42a566e333d7f4d18668971aced21a67b7382f05cceb0b1c83bdc5c4c59075272155b371f9fd4d754bcf8529ade76f35c6ea93113aa493f1369122476d72be8ce8f67e42540d1fdef651ef6df53bc17b160e4f223be93a3b4ad51fc26deaf317516023140ced6818344a0faeff32242cca8fb7cf07df750b0467bf6eff679a6968b5a2daf4728e2b87bca6773ef32b7742eb002a1c176525779827e53263f2b51c93a99874b96154d39926350d20ba0bb931efc648ccb69c98257f85b5fbc8ce9fab41a794cd79a10e0c4828899678ba6fa17d54b222d36b257ba3963950ffa0a478da0bbbe6cd5b8bc56c43ebcc9da77d69e632c8f92dd441afba7e22d38efc6d9966b9275f3e15c4de3eda1e7ebf758ed67de7c2f6576b',
				salt: '488bbfeac98ca321e2bb35d7cbcfec8a',
				userPoolName: '1wCnYCULD',

				context: {
					N: 'ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff',
					g: '2',
					a: 'c19835bf8a4b52710d1d88c45c479d169e9856cdc1349a1947e5dbb1ddfa7503b293bd7791cb4e5cfc68acd82d3abd97bbb3caecc635ac6872a1a643ae00e0701d419f76a50e2f2bebafbfb8266a358929e284e65661d6ead1721951121dc357e03878dca822a54e1f2518abbd5ed8cb3b362cf236be12a19f419bc4be9e9af8',
					A: '932378dad1e9b846d264b3bceda8874c3d6940ec25dd87cb289cd98c669919bc3a3e757d76017d34851db703edc374557eee5a237820221950071e2c16437ce0f606dd6f4f29077ef831fed0bd9bf778327228cedfeb43f34330d86c6c1f285935f6026541e7316b2ce5148d73cd54bfa09e9932d100574646019a856a384604b5774143a0077b2b0e931794bd3735b79d5b11d12635f424e38e9f2a21e667cd4cf9374815edb9988f3c45580da153745d53bccee7a6e2727dfb2d0a6a79d61d8dc71a065e89dd3717197e5ef2796d1fea8be8587c81d431861b3e1e6e1ebb60f7342080246256b6cdcc32e99ff5787526a5cc3f7eeddabaec607ff8bc1ed045188a659d7af1a52ad72f23b19cd0e19d784eb8789896542104019e55f2cc17a96170df1850035791a81101b100ec3418a126521e051c99d901c26252923773ad408bad95ef9f78cdf78cd6d5575333d68eff96bede5a0dd5d7a2d77d9dd2ca48bb4f43e240b3172523627f0cc4d33ce65d356748027778e569880001cf4d03c5',
					k: '538282c4354742d7cbbde2359fcf67f9f5b3a6b08791e5011b43b8a5b66d9ee6'
				},
				result: [15, 84, 202, 208, 197, 102, 132, 138, 250, 221, 17, 61, 80, 250, 72, 6]

			},
			{
				username: 'acc4703d-b81d-4d2b-aed8-1624c68c875d',
				password: '$Password0Final',
				serverBValue: 'f864f3144ba5ad79689f34dcd7dccc257edec2cd5a62059796fcb2c786aa5242f1cd18a643d7c59c8b26f28f04fd7fe7307a91278c8c55cf789f2fb263e9c1d417e10b10977d12d14bc5b6fc9803270199833c0898712c79c0624358f9abd242a370d7e8a39c044860b84a0938e176fac1063fb1d30719801accd1684b87276579693e43f5be0f8cb4643a431c0dd546b83d50aa7abb178b26d16b54f866d0f4551904d06539f3e1cbc35c0efb7851bb5799bfe5008ddc7ad6603d9b829a489036fd4fd1a57543e6ebd9e472fe856feb2198f5fcf1bdef7dead83643b8338685b3388e39aaa63ceb47dd452f96483325a7be37c9057ec2e4ea3645961bd7e0258f1715bea6a9006153985093e61eb9f8e670163053bbc8b6a681fe7f36f3d9dc6c1a8bd2a427b6a7ab3f6be6dbb33874d61aed8b56dbfba53b2e56b46df29f2d4bc14a836debb33d9ea87d4d17ee940beba384bf68fee0ec6651039994c725bb04dd8b7659e7692b56ff7324cac982d869b40f4f8924397133f38de1cc5ea443',
				salt: '5b48dfb930f91cc39b6d81634dfabf2b',
				userPoolName: '1wCnYCULD',

				context: {
					N: 'ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff',
					g: '2',
					a: '6ff61e82fb70d3fec3993d4fb0ca9127555c865d1c9466247dfd365e8f25e3a0dba9a530b44a4d918abe5c454efa8a7fadca6c08d8d2c5b9302bb227068c752e1a4b3684fe00b461adb8fd8998d48a8374c0900f615d8813a60d47cef2601df61420790d62133b498a30ef4836ab8e1983ab91281b7944dfa70567e52dcacf9b',
					A: 'db36c1212d90b0f9c5647e5148f4ea190ac75d73aabb1b498ba9b1125c6486587a16c0aca05ef406db832783e432f2413812e0b17c7751c10563e4db740c977f761b6f88587ed782c28879416adde7ed0a7908ee1ed783bb1da2ec843592b3b236c1db34b5426a4cb56f98fd13ca297e8a1002cf90125fec268c4a7b1bd51b5236acdbf7767795852129a6ba1710f012ba1c08dfbf6aa5102804bd1036b65854ace7e733c39477a28fed62ccd8074cb3500c9818317ca5326af84eea6fafdf77d5c5ea5a9aa437c4e4f40f530a160ea69c29fe42de02f4b723f10c8a9aaf65660ce6a7102a5e023b7b10481e73332f99f9938b68ed889998913c24074a734a24c574d53241a02043c83e6fcfb8e582f8826a1a10091c718c3c7372f55910ed33d41ec33ea0106828475f59c59ca9d0effcccb7dbe05d00cd89bd8b34d966ef227c6339893d7272fb5b327b969e201f3255c4c94fc8fd3169227527a17092aff6231aa300b4d852ad19accb771b5e6f32730d6610f30254baf290ab0b5bcbf836',
					k: '538282c4354742d7cbbde2359fcf67f9f5b3a6b08791e5011b43b8a5b66d9ee6'
				},
				result: [174, 95, 119, 186, 160, 28, 17, 196, 56, 87, 115, 34, 23, 181, 58, 251]

			}
		].forEach(({username, password, serverBValue, salt, userPoolName, result, context}, i) => {
			test(`should be consistent with precalculated SRP regression values ${i}`, () => {
				const parsedContext = {};
				Object.keys(context).forEach(key => parsedContext[key] = parseBigInt(context[key], 16));
				expect(underTest.getPasswordAuthenticationKey({username, password, serverBValue: parseBigInt(serverBValue, 16), salt: parseBigInt(salt, 16), userPoolName}, parsedContext)).toEqual(Uint8Array.from(result));
			});
		});
	});

});
